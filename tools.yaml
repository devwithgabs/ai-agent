sources:
  furniture-bq-source:
    kind: bigquery
    project: adk-demo-469711

tools:
  explore_tables:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT table_name, column_name, data_type
      FROM `adk-demo-469711.mobilis.INFORMATION_SCHEMA.COLUMNS`
      ORDER BY table_name, ordinal_position
    description: |
      Explore the database schema to understand table structure.

  check_stores:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT *
      FROM `adk-demo-469711.mobilis.stores`
      LIMIT 10
    description: |
      Check what stores exist in the database.

  list_store_ids:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT DISTINCT store_id, store_name, city, address
      FROM `adk-demo-469711.mobilis.stores`
      ORDER BY store_id
    description: |
      List all available store IDs and their basic information.

  check_stock_by_store:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT store_id, COUNT(*) as inventory_count, 
             SUM(available_quantity) as total_items
      FROM `adk-demo-469711.mobilis.stock`
      GROUP BY store_id
      ORDER BY store_id
    description: |
      Show inventory count by store ID to see which stores have stock data.

  debug_store_006:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 'stores_table' as source, store_id, store_name
      FROM `adk-demo-469711.mobilis.stores`
      WHERE store_id LIKE '%006%' OR store_id LIKE '%6%'
      UNION ALL
      SELECT 'stock_table' as source, store_id, CAST(COUNT(*) AS STRING) as count
      FROM `adk-demo-469711.mobilis.stock`
      WHERE store_id LIKE '%006%' OR store_id LIKE '%6%'
      GROUP BY store_id
    description: |
      Debug tool to find any store ID containing '006' or '6' in both tables.

  check_products:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT *
      FROM `adk-demo-469711.mobilis.products`
      LIMIT 10
    description: |
      Check what products exist in the database.

  check_stock:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT *
      FROM `adk-demo-469711.mobilis.stock`
      LIMIT 10
    description: |
      Check what stock data exists in the database.

  get_store_inventory:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 
        p.product_name,
        p.category,
        s.color,
        s.available_quantity,
        s.location_in_store,
        p.base_price
      FROM `adk-demo-469711.mobilis.stock` s
      JOIN `adk-demo-469711.mobilis.products` p ON s.product_id = p.product_id
      WHERE s.store_id = @store_id
        AND s.available_quantity > 0
      ORDER BY p.category, p.product_name
    parameters:
      - name: store_id
        type: string
        description: Store ID to check inventory for
    description: |
      Get inventory for a specific store by store ID, including product prices.

  search_products:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT DISTINCT 
        p.product_name,
        p.category,
        p.base_price,
        COUNT(s.store_id) as stores_with_stock,
        SUM(s.available_quantity) as total_available
      FROM `adk-demo-469711.mobilis.products` p
      LEFT JOIN `adk-demo-469711.mobilis.stock` s ON p.product_id = s.product_id
      WHERE LOWER(p.product_name) LIKE LOWER(CONCAT('%', @product_name, '%'))
        AND s.available_quantity > 0
      GROUP BY p.product_name, p.category, p.base_price
      ORDER BY p.product_name
    parameters:
      - name: product_name
        type: string
        description: Product name to search for
    description: |
      Search for products by name across all stores, showing prices and availability.

  check_product_availability:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 
        st.store_name,
        st.store_id,
        p.product_name,
        p.category,
        p.base_price,
        s.color,
        s.available_quantity,
        s.location_in_store
      FROM `adk-demo-469711.mobilis.stock` s
      JOIN `adk-demo-469711.mobilis.stores` st ON s.store_id = st.store_id
      JOIN `adk-demo-469711.mobilis.products` p ON s.product_id = p.product_id
      WHERE LOWER(p.product_name) LIKE LOWER(CONCAT('%', @product_name, '%'))
        AND s.available_quantity > 0
      ORDER BY st.store_name, p.product_name
    parameters:
      - name: product_name
        type: string
        description: Product name to search for
    description: |
      Check which stores have a specific product in stock, including prices.

  simple_test_query:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT COUNT(*) as total_records
      FROM `adk-demo-469711.mobilis.stock`
    description: |
      Simple test query to verify BigQuery connection works.

  search_by_store_name:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 
        st.store_name,
        st.store_id,
        p.product_name,
        p.category,
        p.base_price,
        s.color,
        s.available_quantity,
        s.location_in_store
      FROM `adk-demo-469711.mobilis.stock` s
      JOIN `adk-demo-469711.mobilis.stores` st ON s.store_id = st.store_id
      JOIN `adk-demo-469711.mobilis.products` p ON s.product_id = p.product_id
      WHERE LOWER(st.store_name) LIKE LOWER(CONCAT('%', @store_name, '%'))
        AND LOWER(p.product_name) LIKE LOWER(CONCAT('%', @product_name, '%'))
        AND s.available_quantity > 0
    parameters:
      - name: store_name
        type: string
        description: Store name to search for
      - name: product_name
        type: string
        description: Product name to search for
    description: |
      Search for specific products at a specific store by name, including prices.

  check_our_store_inventory:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 
        st.store_name,
        st.store_id,
        p.product_name,
        p.category,
        s.color,
        s.available_quantity,
        s.location_in_store,
        p.base_price
      FROM `adk-demo-469711.mobilis.stock` s
      JOIN `adk-demo-469711.mobilis.stores` st ON s.store_id = st.store_id
      JOIN `adk-demo-469711.mobilis.products` p ON s.product_id = p.product_id
      WHERE s.store_id = @store_id
        AND s.available_quantity > 0
      ORDER BY p.category, p.product_name
    parameters:
      - name: store_id
        type: string
        description: Our store ID (use STORE_001 for our current store)
    description: |
      Check inventory specifically for OUR store. Use STORE_001 as the store_id parameter.

  get_our_store_info:
    kind: bigquery-sql
    source: furniture-bq-source
    statement: |
      SELECT 
        store_id,
        store_name,
        city,
        address,
        phone,
        manager_name
      FROM `adk-demo-469711.mobilis.stores`
      WHERE store_id = @store_id
    parameters:
      - name: store_id
        type: string
        description: Our store ID (use STORE_001)
    description: |
      Get detailed information about OUR store. Use STORE_001 as the store_id parameter.

toolsets:
  furniture_toolset:
    - explore_tables
    - check_stores
    - list_store_ids
    - check_stock_by_store
    - debug_store_006
    - check_products
    - check_stock
    - get_store_inventory
    - search_products
    - check_product_availability
    - simple_test_query
    - search_by_store_name
    - check_our_store_inventory
    - get_our_store_info
